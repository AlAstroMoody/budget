function o(e){return new Promise((n,t)=>{e.oncomplete=e.onsuccess=()=>n(e.result),e.onabort=e.onerror=()=>t(e.error)})}function l(e,n){let t;const r=()=>{if(t)return t;const u=indexedDB.open(e);return u.onupgradeneeded=()=>u.result.createObjectStore(n),t=o(u),t.then(i=>{i.onclose=()=>t=void 0},()=>{}),t};return(u,i)=>r().then(a=>i(a.transaction(n,u).objectStore(n)))}let s;function c(){return s||(s=l("keyval-store","keyval")),s}function f(e,n=c()){return n("readonly",t=>o(t.get(e)))}function p(e,n,t=c()){return t("readwrite",r=>(r.put(n,e),o(r.transaction)))}function y(e,n=c()){return n("readwrite",t=>(t.delete(e),o(t.transaction)))}function d(e,n){return e.openCursor().onsuccess=function(){this.result&&(n(this.result),this.result.continue())},o(e.transaction)}function h(e=c()){return e("readonly",n=>{if(n.getAllKeys)return o(n.getAllKeys());const t=[];return d(n,r=>t.push(r.key)).then(()=>t)})}export{y as d,f as g,h as k,p as s};
